import{_ as a,o as t,c as e,b as n,d as p,a as o}from"./app-037f133e.js";const c={},l=n("h1",{style:{"text-align":"center"}},"Vite 适配低版本浏览器",-1),i=n("div",{style:{display:"flex",color:"#999","justify-content":"space-around"}},[n("div",null,"作者：陈佳鑫"),n("div",null,"时间：2023-12-08")],-1),u=n("br",null,null,-1),r=n("p",null,"使用Vite + Vue3 + Vant 开发H5应用，因手机安卓版本型号过低，所以Google浏览器版本过低，打包后不适应ES6语法，所以要使用babel打包为ES5版本",-1),d=n("h3",{id:"浏览器console信息",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#浏览器console信息","aria-hidden":"true"},"#"),p(" 浏览器Console信息")],-1),k=n("br",null,null,-1),v=["src"],b=o(`<h3 id="解决globalthis-错误" tabindex="-1"><a class="header-anchor" href="#解决globalthis-错误" aria-hidden="true">#</a> 解决globalThis 错误</h3><p>因为ES5兼容问题会报globalThis is not defined我们需要在index.html文件加入兼容</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token operator">||</span> self<span class="token punctuation">;</span>
      <span class="token punctuation">(</span>e<span class="token punctuation">.</span>globalThis <span class="token operator">=</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">delete</span> t<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_T_
    <span class="token punctuation">}</span>
    <span class="token string">&#39;object&#39;</span> <span class="token operator">!=</span> <span class="token keyword">typeof</span> globalThis <span class="token operator">&amp;&amp;</span>
      <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">?</span>
        <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span>
        <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">&#39;_T_&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token literal-property property">get</span><span class="token operator">:</span> e
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          _T_<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Object<span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="安装-rollup-plugin-esbuild" tabindex="-1"><a class="header-anchor" href="#安装-rollup-plugin-esbuild" aria-hidden="true">#</a> 安装 rollup-plugin-esbuild</h3><div class="language-npm line-numbers-mode" data-ext="npm"><pre class="language-npm"><code>yarn add rollup-plugin-esbuild
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="配置-babelrc" tabindex="-1"><a class="header-anchor" href="#配置-babelrc" aria-hidden="true">#</a> 配置 .babelrc</h3><p>新建.babelrc文件</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="vite-config-ts-配置" tabindex="-1"><a class="header-anchor" href="#vite-config-ts-配置" aria-hidden="true">#</a> vite.config.ts 配置</h3><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">esbuild</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      target<span class="token operator">:</span> <span class="token string">&#39;chrome64&#39;</span><span class="token punctuation">,</span>
      loaders<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;.vue&#39;</span><span class="token operator">:</span> <span class="token string">&#39;js&#39;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&#39;.ts&#39;</span><span class="token operator">:</span> <span class="token string">&#39;js&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  build<span class="token operator">:</span> <span class="token punctuation">{</span>
    minify<span class="token operator">:</span> <span class="token string">&#39;terser&#39;</span><span class="token punctuation">,</span>
    target<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;edge90&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;chrome90&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;firefox90&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;safari15&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 适配低版本浏览器</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10);function m(s,g){return t(),e("div",null,[l,i,u,r,d,k,n("img",{class:"avatar",src:s.$withBase("/ViteES5.png")},null,8,v),b])}const f=a(c,[["render",m],["__file","ViteES5.html.vue"]]);export{f as default};
